<!DOCTYPE html>
<html>
  <head>
    <title>Ajax Test</title>
  </head>
  <body>
    <h1>Ajax Test</h1>
    <button id='same'>Same Origin</button>
    <button id='diff'>Different Origin</button>
    <button id='cors'>Cross Origin</button>
    <button id='json'>CORS JSON</button>
    <ul id='result'>
    </ul>
    <script>
    function responseHandler() {
      var li = document.createElement('li');
      if (this.status === 200) {
        console.dir(this);
        if (this.responseType === 'application/json') {
          li.innerHTML = JSON.parse(this.responseText).message;
        } else {
          li.innerHTML = this.responseText;
        }
      } else {
        li.innerHTML = 'Got an error: ' + this.status;
      }
      document.getElementById('result').appendChild(li);
    }
    document.getElementById('same').addEventListener('click', function () {
      var r = new XMLHttpRequest();
      r.onerror = r.onabort = r.onload = responseHandler;
      r.open('get', 'test.txt', true);
      r.send();
    });
    document.getElementById('diff').addEventListener('click', function () {
      var r = new XMLHttpRequest();
      r.onerror = r.onabort = r.onload = responseHandler;
      r.open('get', 'http://raw.github.com/scs-cs-50/ajax/1_basic/test.txt', true);
      r.send();
    });
    document.getElementById('cors').addEventListener('click', function () {
      var r = new XMLHttpRequest();
      r.onerror = r.onabort = r.onload = responseHandler;
      r.open('get', 'https://experiments.itlab.stanford.edu/cors/', true);
      r.send();
    });
    document.getElementById('json').addEventListener('click', function () {
      var r = new XMLHttpRequest();
      // force a non-simple CORS request
      r.onerror = r.onabort = r.onload = responseHandler;
      r.open('post', 'https://experiments.itlab.stanford.edu/cors/', true);
      r.setRequestHeader('content-type', 'application/json');
      r.send();
    });

    </script>
  </body>
</html>